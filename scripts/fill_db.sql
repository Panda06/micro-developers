-- 1. Профили пользователей (сначала профили, так как users ссылается на них)
INSERT INTO user_profiles (user_id, last_name, first_name, middle_name, birth_date, gender) VALUES
(1, 'Петров', 'Иван', 'Алексеевич', '1985-05-15', 'М'),
(2, 'Сидорова', 'Мария', 'Викторовна', '1990-08-22', 'Ж'),
(3, 'Козлов', 'Александр', 'Петрович', '1982-03-10', 'М'),
(4, 'Новак', 'Елена', 'Сергеевна', '1995-12-05', 'Ж'),
(5, 'Волков', 'Дмитрий', 'Игоревич', '1988-07-30', 'М'),
(999, 'Тестовый', 'Пользователь', 'Тестович', '1990-01-01', 'М');

-- 2. Пользователи
INSERT INTO users (id, keycloack_id, email, phone, user_type, created_at) VALUES
(1, 'auth_1001', 'ivan.petrov@email.com', '+79001234567', 'resident', '2024-01-15 10:00:00'),
(2, 'auth_1002', 'maria.sidorova@email.com', '+79002345678', 'resident', '2024-01-20 11:00:00'),
(3, 'auth_1003', 'alex.kozlov@email.com', '+79003456789', 'resident', '2024-02-01 12:00:00'),
(4, 'auth_1004', 'elena.novak@email.com', '+79004567890', 'resident', '2024-02-15 13:00:00'),
(5, 'auth_1005', 'dmitry.volkov@email.com', '+79005678901', 'resident', '2024-03-01 14:00:00'),
(999, 'test_user_123', 'test@example.com', '+79999999999', 'resident', '2024-01-01 00:00:00');

-- 3. Адреса пользователей
INSERT INTO user_addresses (id, user_id, region, city, street, house, flat, residents_counts, area, created_at) VALUES
(1, 1, 'Московская область', 'Москва', 'ул. Ленина', '10', '25', 3, 65.5, '2024-01-15 10:15:00'),
(2, 1, 'Московская область', 'Москва', 'ул. Пушкина', '5', '12', 2, 45.8, '2024-01-15 10:20:00'),
(3, 2, 'Санкт-Петербург', 'Санкт-Петербург', 'Невский проспект', '45', '78', 4, 85.2, '2024-01-20 11:15:00'),
(4, 3, 'Московская область', 'Москва', 'ул. Гагарина', '20', '33', 2, 55.0, '2024-02-01 12:15:00'),
(5, 3, 'Московская область', 'Москва', 'ул. Советская', '15', '7', 1, 35.5, '2024-02-01 12:20:00'),
(6, 4, 'Екатеринбург', 'Екатеринбург', 'ул. Малышева', '30', '45', 3, 72.3, '2024-02-15 13:15:00'),
(7, 5, 'Новосибирск', 'Новосибирск', 'ул. Красный проспект', '25', '89', 2, 58.7, '2024-03-01 14:15:00'),
(8, 999, 'Московская область', 'Москва', 'Тестовая ул.', '1', '1', 1, 50.0, '2024-01-01 00:15:00'),
(9, 999, 'Московская область', 'Москва', 'Тестовая ул.', '2', '2', 2, 75.0, '2024-01-01 00:20:00');

-- 4. Поставщики услуг
INSERT INTO providers (id, name, inn, ogrn, created_at) VALUES
(1, 'ГУП "Мосводоканал"', '770100123456', '1027700001234', '2024-01-01 09:00:00'),
(2, 'ОАО "Мосэнерго"', '770200234567', '1027700002345', '2024-01-01 09:30:00'),
(3, 'ООО "УК Комфорт"', '770300345678', '1027700003456', '2024-01-01 10:00:00'),
(4, 'АО "Теплосеть СПб"', '780400456789', '1027800004567', '2024-01-01 10:30:00'),
(5, 'ОАО "Свердловэнерго"', '660500567890', '1026600005678', '2024-01-01 11:00:00');

-- 5. Услуги (service_name как BIGINT - код услуги)
INSERT INTO services (service_name, provider_id, cost_per_unit) VALUES
('ХВС', 1, 35.50), 
('ГВС', 1, 185.20), 
('ВО', 1, 28.75), 
('ЭЭ', 2, 4.85),  
('Отопление', 2, 2800.00),
('Содержание жилья', 3, 25.00),
('Капитальный ремонт', 3, 12.50),
('Теплоснабжение СПб', 4, 3200.00),
('ЭЭ Урал', 5, 5.20);

-- 6. Лицевые счета (по 1-2 на пользователя)
INSERT INTO accounts (id, user_id, account_number, address_id, provider_id, created_at, is_active, is_deleted) VALUES
(1, 1, '1234567890', 1, 1, '2024-01-15 10:30:00', true, false),
(2, 1, '1234567891', 2, 2, '2024-01-15 10:35:00', false, false),
(3, 2, '2345678901', 3, 4, '2024-01-20 11:30:00', true, false),
(4, 3, '3456789012', 4, 1, '2024-02-01 12:30:00', true, false),
(5, 3, '3456789013', 5, 3, '2024-02-01 12:35:00', false, false),
(6, 4, '4567890123', 6, 5, '2024-02-15 13:30:00', true, false),
(7, 5, '5678901234', 7, 2, '2024-03-01 14:30:00', true, false),
(8, 999, '9999999991', 8, 1, '2024-01-01 00:30:00', true, false),  -- Тестовый водоканал
(9, 999, '9999999992', 9, 2, '2024-01-01 00:35:00', true, false),  -- Тестовый электричество
(10, 999, '9999999993', 8, 3, '2024-01-01 00:40:00', true, false); -- Тестовый УК

-- 7. Начисления за 9 месяцев (апрель-декабрь 2024)
-- status_type: 1 = неоплачено, 2 = оплачено
INSERT INTO bills (id, account_id, service_id, period, amount, status_type, last_data, units) VALUES

-- Счет 1234567890 (Петров, адрес 1) - водоканал
-- Апрель 2024 - оплачено
(1, 1, 1, '2024-04-01', 177.50, 'paid', 100.0, 5.0),   -- Холодная вода
(2, 1, 2, '2024-04-01', 555.60, 'paid', 50.0, 3.0),    -- Горячая вода  
(3, 1, 3, '2024-04-01', 230.00, 'paid', 150.0, 8.0),   -- Водоотведение

-- Май 2024 - оплачено
(4, 1, 1, '2024-05-01', 213.00, 'paid', 105.0, 6.0),
(5, 1, 2, '2024-05-01', 740.80, 'paid', 53.0, 4.0), 
(6, 1, 3, '2024-05-01', 287.50, 'paid', 158.0, 10.0),

-- Июнь 2024 - оплачено  
(7, 1, 1, '2024-06-01', 248.50, 'paid', 111.0, 7.0),
(8, 1, 2, '2024-06-01', 926.00, 'paid', 57.0, 5.0),
(9, 1, 3, '2024-06-01', 345.00, 'paid', 168.0, 12.0),

-- Июль 2024 - неоплачено
(10, 1, 1, '2024-07-01', 284.00, 'pending', 119.0, 8.0),
(11, 1, 2, '2024-07-01', 1111.20, 'pending', 63.0, 6.0),
(12, 1, 3, '2024-07-01', 402.50, 'pending', 180.0, 14.0),

-- Август 2024 - неоплачено
(13, 1, 1, '2024-08-01', 319.50, 'pending', 128.0, 9.0),
(14, 1, 2, '2024-08-01', 1296.40, 'pending', 70.0, 7.0),
(15, 1, 3, '2024-08-01', 460.00, 'pending', 194.0, 16.0),

-- Счет 1234567891 (Петров, адрес 2) - электричество и отопление
-- Апрель 2024 - оплачено
(16, 2, 4, '2024-04-01', 388.00, 2, 150.0, 80.0),  -- Электричество
(17, 2, 5, '2024-04-01', 3360.00, 2, 0.0, 1.2),    -- Отопление

-- Май 2024 - оплачено
(18, 2, 4, '2024-05-01', 436.50, 2, 230.0, 90.0),
(19, 2, 5, '2024-05-01', 3360.00, 2, 0.0, 1.2),

-- Июнь 2024 - оплачено
(20, 2, 4, '2024-06-01', 485.00, 2, 320.0, 100.0),
(21, 2, 5, '2024-06-01', 3360.00, 2, 0.0, 1.2),

-- Июль 2024 - неоплачено
(22, 2, 4, '2024-07-01', 533.50, 1, 420.0, 110.0),
(23, 2, 5, '2024-07-01', 3360.00, 1, 0.0, 1.2),

-- Счет 2345678901 (Сидорова) - теплоснабжение СПб
-- Апрель-май оплачено, июнь-июль неоплачено
(24, 3, 8, '2024-04-01', 3840.00, 2, 0.0, 1.2),    -- Теплоснабжение
(25, 3, 8, '2024-05-01', 3840.00, 2, 0.0, 1.2),
(26, 3, 8, '2024-06-01', 3840.00, 1, 0.0, 1.2),    -- неоплачено
(27, 3, 8, '2024-07-01', 3840.00, 1, 0.0, 1.2),    -- неоплачено

-- Счет 3456789012 (Козлов, адрес 1) - водоканал
-- Апрель-май оплачено, июнь неоплачено
(28, 4, 1, '2024-04-01', 248.50, 2, 80.0, 7.0),
(29, 4, 2, '2024-04-01', 740.80, 2, 40.0, 4.0),
(30, 4, 1, '2024-05-01', 284.00, 2, 87.0, 8.0),
(31, 4, 2, '2024-05-01', 926.00, 2, 45.0, 5.0),
(32, 4, 1, '2024-06-01', 319.50, 1, 95.0, 9.0),    -- неоплачено
(33, 4, 2, '2024-06-01', 1111.20, 1, 51.0, 6.0),   -- неоплачено

-- Счет 3456789013 (Козлов, адрес 2) - УК
-- Апрель-май оплачено, июнь неоплачено
(34, 5, 6, '2024-04-01', 1500.00, 2, 0.0, 60.0),   -- Содержание жилья
(35, 5, 7, '2024-04-01', 750.00, 2, 0.0, 60.0),    -- Капремонт
(36, 5, 6, '2024-05-01', 1500.00, 2, 0.0, 60.0),
(37, 5, 7, '2024-05-01', 750.00, 2, 0.0, 60.0),
(38, 5, 6, '2024-06-01', 1500.00, 1, 0.0, 60.0),   -- неоплачено
(39, 5, 7, '2024-06-01', 750.00, 1, 0.0, 60.0),    -- неоплачено

-- Счет 4567890123 (Новак) - электричество Урал
-- Апрель-май оплачено, июнь неоплачено
(40, 6, 9, '2024-04-01', 520.00, 2, 100.0, 100.0),
(41, 6, 9, '2024-05-01', 572.00, 2, 200.0, 110.0),
(42, 6, 9, '2024-06-01', 624.00, 1, 320.0, 120.0), -- неоплачено

-- Счет 5678901234 (Волков) - электричество Москва
-- Апрель-май оплачено, июнь неоплачено
(43, 7, 4, '2024-04-01', 485.00, 2, 150.0, 100.0),
(44, 7, 4, '2024-05-01', 533.50, 2, 250.0, 110.0),
(45, 7, 4, '2024-06-01', 582.00, 1, 370.0, 120.0), -- неоплачено

-- Тестовые счета (пользователь 999)
-- Счет 9999999991 (водоканал) - апрель-май оплачено, июнь-июль неоплачено
(46, 8, 1, '2024-04-01', 142.00, 2, 50.0, 4.0),    -- Холодная вода
(47, 8, 2, '2024-04-01', 370.40, 2, 25.0, 2.0),    -- Горячая вода
(48, 8, 3, '2024-04-01', 172.50, 2, 75.0, 6.0),    -- Водоотведение
(49, 8, 1, '2024-05-01', 177.50, 2, 54.0, 5.0),
(50, 8, 2, '2024-05-01', 555.60, 2, 28.0, 3.0),
(51, 8, 3, '2024-05-01', 230.00, 2, 81.0, 8.0),
(52, 8, 1, '2024-06-01', 213.00, 1, 60.0, 6.0),    -- неоплачено
(53, 8, 2, '2024-06-01', 740.80, 1, 32.0, 4.0),    -- неоплачено
(54, 8, 3, '2024-06-01', 287.50, 1, 90.0, 10.0),   -- неоплачено
(55, 8, 1, '2024-07-01', 248.50, 1, 67.0, 7.0),    -- неоплачено
(56, 8, 2, '2024-07-01', 926.00, 1, 37.0, 5.0),    -- неоплачено
(57, 8, 3, '2024-07-01', 345.00, 1, 102.0, 12.0),  -- неоплачено

-- Счет 9999999992 (электричество) - апрель оплачено, май-июль неоплачено  
(58, 9, 4, '2024-04-01', 340.30, 2, 100.0, 70.0),
(59, 9, 4, '2024-05-01', 388.00, 1, 170.0, 80.0),  -- неоплачено
(60, 9, 4, '2024-06-01', 436.50, 1, 260.0, 90.0),  -- неоплачено
(61, 9, 4, '2024-07-01', 485.00, 1, 360.0, 100.0), -- неоплачено

-- Счет 9999999993 (УК) - апрель-май оплачено, июнь-июль неоплачено
(62, 10, 6, '2024-04-01', 1250.00, 2, 0.0, 50.0),  -- Содержание жилья
(63, 10, 7, '2024-04-01', 625.00, 2, 0.0, 50.0),   -- Капремонт
(64, 10, 6, '2024-05-01', 1250.00, 2, 0.0, 50.0),
(65, 10, 7, '2024-05-01', 625.00, 2, 0.0, 50.0),
(66, 10, 6, '2024-06-01', 1250.00, 1, 0.0, 50.0),  -- неоплачено
(67, 10, 7, '2024-06-01', 625.00, 1, 0.0, 50.0),   -- неоплачено
(68, 10, 6, '2024-07-01', 1250.00, 1, 0.0, 50.0),  -- неоплачено
(69, 10, 7, '2024-07-01', 625.00, 1, 0.0, 50.0);   -- неоплачено

-- 8. Платежи (группировка по периодам и аккаунтам)
INSERT INTO payments (id, account_id, amount, paid_at, status) VALUES
-- Платежи за апрель 2024
(1, 1, 964, '2024-04-15 10:00:00', 'completed'),    -- Петров счет 1: ХВС+ГВС+ВО (178+556+230)
(2, 2, 3748, '2024-04-16 11:00:00', 'completed'),   -- Петров счет 2: ЭЭ+Отопление (388+3360)
(3, 3, 3840, '2024-04-17 12:00:00', 'completed'),   -- Сидорова: Теплоснабжение
(4, 4, 990, '2024-04-18 13:00:00', 'completed'),    -- Козлов счет 1: ХВС+ГВС (249+741)
(5, 5, 2250, '2024-05-05 16:00:00', 'completed'),   -- Козлов счет 2: Содержание+Капремонт (1500+750)
(6, 6, 520, '2024-05-10 17:00:00', 'completed'),    -- Новак: ЭЭ Урал
(7, 7, 485, '2024-05-15 18:00:00', 'completed'),    -- Волков: ЭЭ Москва
(8, 8, 685, '2024-04-10 09:00:00', 'completed'),    -- Тест водоканал: ХВС+ГВС+ВО (142+370+173)
(9, 9, 340, '2024-04-11 10:00:00', 'completed'),    -- Тест электричество
(10, 10, 1875, '2024-04-12 11:00:00', 'completed'), -- Тест УК: Содержание+Капремонт (1250+625)

-- Платежи за май 2024
(11, 1, 1242, '2024-05-15 10:00:00', 'completed'),  -- Петров счет 1: ХВС+ГВС+ВО (213+741+288)
(12, 2, 3797, '2024-05-16 11:00:00', 'completed'),  -- Петров счет 2: ЭЭ+Отопление (437+3360)
(13, 3, 3840, '2024-05-17 12:00:00', 'completed'),  -- Сидорова: Теплоснабжение
(14, 4, 1210, '2024-05-18 13:00:00', 'completed'),  -- Козлов счет 1: ХВС+ГВС (284+926)
(15, 5, 2250, '2024-05-19 14:00:00', 'completed'),  -- Козлов счет 2: Содержание+Капремонт (1500+750)
(16, 6, 572, '2024-05-20 15:00:00', 'completed'),   -- Новак: ЭЭ Урал
(17, 7, 534, '2024-05-21 16:00:00', 'completed'),   -- Волков: ЭЭ Москва
(18, 8, 964, '2024-05-10 09:00:00', 'completed'),   -- Тест водоканал: ХВС+ГВС+ВО (178+556+230)
(19, 10, 1875, '2024-05-12 11:00:00', 'completed'), -- Тест УК: Содержание+Капремонт (1250+625)

-- Платежи за июнь 2024
(20, 1, 1520, '2024-06-15 10:00:00', 'completed'),  -- Петров счет 1: ХВС+ГВС+ВО (249+926+345)
(21, 2, 3845, '2024-06-16 11:00:00', 'completed');  -- Петров счет 2: ЭЭ+Отопление (485+3360)

-- 9. Связи платежей со счетами
INSERT INTO payment_bills (payment_id, bill_id) VALUES
-- Платеж 1 (Петров счет 1, апрель): bills 1,2,3
(1, 1), (1, 2), (1, 3),
-- Платеж 2 (Петров счет 2, апрель): bills 16,17
(2, 16), (2, 17),
-- Платеж 3 (Сидорова, апрель): bill 24
(3, 24),
-- Платеж 4 (Козлов счет 1, апрель): bills 28,29
(4, 28), (4, 29),
-- Платеж 5 (Козлов счет 2, апрель): bills 34,35
(5, 34), (5, 35),
-- Платеж 6 (Новак, апрель): bill 40
(6, 40),
-- Платеж 7 (Волков, апрель): bill 43
(7, 43),
-- Платеж 8 (Тест водоканал, апрель): bills 46,47,48
(8, 46), (8, 47), (8, 48),
-- Платеж 9 (Тест электричество, апрель): bill 58
(9, 58),
-- Платеж 10 (Тест УК, апрель): bills 62,63
(10, 62), (10, 63),

-- Платеж 11 (Петров счет 1, май): bills 4,5,6
(11, 4), (11, 5), (11, 6),
-- Платеж 12 (Петров счет 2, май): bills 18,19
(12, 18), (12, 19),
-- Платеж 13 (Сидорова, май): bill 25
(13, 25),
-- Платеж 14 (Козлов счет 1, май): bills 30,31
(14, 30), (14, 31),
-- Платеж 15 (Козлов счет 2, май): bills 36,37
(15, 36), (15, 37),
-- Платеж 16 (Новак, май): bill 41
(16, 41),
-- Платеж 17 (Волков, май): bill 44
(17, 44),
-- Платеж 18 (Тест водоканал, май): bills 49,50,51
(18, 49), (18, 50), (18, 51),
-- Платеж 19 (Тест УК, май): bills 64,65
(19, 64), (19, 65),

-- Платеж 20 (Петров счет 1, июнь): bills 7,8,9
(20, 7), (20, 8), (20, 9),
-- Платеж 21 (Петров счет 2, июнь): bills 20,21
(21, 20), (21, 21);

-- Обновляем sequence для SERIAL полей
SELECT setval('user_addresses_id_seq', (SELECT MAX(id) FROM user_addresses));
SELECT setval('providers_id_seq', (SELECT MAX(id) FROM providers));
SELECT setval('services_id_seq', (SELECT MAX(id) FROM services));
SELECT setval('accounts_id_seq', (SELECT MAX(id) FROM accounts));
SELECT setval('bills_id_seq', (SELECT MAX(id) FROM bills));
SELECT setval('payments_id_seq', (SELECT MAX(id) FROM payments));
SELECT setval('payment_bills_id_seq', (SELECT MAX(id) FROM payment_bills)); 